clear
clear global
close all
clc

ttt = readtable('..\trajectories.csv');
se = Country('Sweden',0);

seDate = se.dates;
% seDeaths7 = movmean(se.deaths, 7);
seDeaths = movmean(se.deaths, 14);
seCases = movmean(se.cases, 14);

ukDate =  table2array(ttt(strcmp(ttt.area,'Denmark'), 'date'));
ukDeaths = movmean(str2double(table2array(ttt(strcmp(ttt.area,'Denmark'), 'new_deaths'))), 14);

timeMask1 = 1:1+150+35;
seDate1 = seDate(timeMask1);
seDeaths1 = seDeaths(timeMask1);

% timeMask = 300-35+3:300+150+3;
timeMask = 250:481;
seDate = seDate(timeMask);
seDeaths = seDeaths(timeMask);
seCases = seCases(timeMask);
% seDeaths7 = seDeaths7(timeMask);
ukDate = ukDate(timeMask);
ukDeaths = ukDeaths(timeMask);

vaccdates = datetime('27-Dec-2020')+7*(0:20);

vacc1 = [2254,...
15669,...
50687,...
128179,...
230688,...
294218,...
337781,...
383396,...
452734,...
552536,...
699444,...
877895,...
997087,...
1126091,...
1321700,...
1568954,...
1977158,...
2373384,...
2738436,...
3067718,...
3321495]

vacc2 = [0,...
0,...
0,...
10,...
36,...
10292,...
35595,...
90958,...
160461,...
241299,...
293661,...
329626,...
368969,...
423974,...
491680,...
558948,...
651457,...
716899,...
754831,...
782081,...
893520,...
1024354]

% p1 = plot(seDeaths, 'LineWidth', 2); hold on;
% p2 = plot(seDeaths1, 'LineWidth', 2);
% l1 = line([80, 80], [0, 100], 'LineStyle', '--', 'LineWidth', 1, 'Color', p1.Color());
% p3 = plot(90+7*(1:length(vacc1)), 100*vacc1/se.population, 'LineWidth', 2);
% line([97, 97], [0, 100], 'LineStyle', '--', 'LineWidth', 1, 'Color', p3.Color());
% hold off;
% xlim([40,180])
% legend('# döda, vinter','# döda, sommar','3v efter 18 december', '2v efter vacc. 1 spruta, % pop.')
% grid
% xlabel('dag')

figure
plot(seDate, seCases, 'LineWidth', 2); hold on
% plot(seDate, seDeaths/max(seDeaths), seDate, seCases/max(seCases), vaccdates+14, vacc1/se.population, 'LineWidth', 2); hold on
line([datetime('18-Dec-2020') datetime('18-Dec-2020')], [0, 7000], 'LineStyle', '--', 'Color', 'k');
% line([datetime('4-Jan-2021') datetime('4-Jan-2021')], [0, 1], 'LineStyle', '--', 'Color', 'k');
% line([datetime('24-Dec-2020') datetime('24-Dec-2020')], [0, 1], 'LineStyle', '--', 'Color', 'k');
line([datetime('18-Dec-2020') datetime('18-Dec-2020')]+14, [0, 7000], 'LineStyle', '--', 'Color', 'k'); hold off
% line([datetime('18-Dec-2020') datetime('18-Dec-2020')]+21, [0, 1], 'LineStyle', '--', 'Color', 'k'); hold off
% line([datetime('18-Dec-2020') datetime('18-Dec-2020')]+44, [0, 1], 'LineStyle', '--', 'Color', 'k'); hold off
grid
xlim([datetime('1-Nov-2020') datetime('1-Apr-2021')])

